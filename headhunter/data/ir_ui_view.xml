<?xml version='1.0' encoding='UTF-8'?>
<odoo>
    <record id="applicants_customization_tree_view" model="ir.ui.view">
        <field name="name">Applicants customization</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.crm_case_tree_view_job" />
        <field name="mode">extension</field>
        <field name="active" eval="True"/>
        <field name="priority">160</field>
        <field name="arch" type="xml">
            <data>
                <xpath expr="//field[@name='create_date']" position="after">
                    <field name="x_opportunities" optional="show" />
                </xpath>
                <xpath expr="//field[@name='availability']" position="before">
                    <field name="x_available" optional="hide" />
                </xpath>
            </data>
        </field>
    </record>
    <record id="crm_lead_customization_form_view" model="ir.ui.view">
        <field name="name">crm.lead.form.customization</field>
        <field name="model">crm.lead</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form" />
        <field name="mode">extension</field>
        <field name="active" eval="True"/>
        <field name="priority">160</field>
        <field name="arch" type="xml">
            <data>
                <xpath expr="//button[@name='action_redirect_to_page_views']" position="replace">
                    <button class="oe_stat_button" icon="fa-users" type="action" name="%(headhunter_crm_case_categ0_act_job)d">
                        <field widget="statinfo" name="x_opportunities_count" string="Applicants" />
                    </button>
                </xpath>
            </data>
        </field>
    </record>
    <record id="jobs_recruitment_customization_form_view" model="ir.ui.view">
        <field name="name">Jobs - Recruitment Form customization</field>
        <field name="model">hr.applicant</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_form" />
        <field name="mode">extension</field>
        <field name="active" eval="True"/>
        <field name="priority">500</field>
        <field name="arch" type="xml">
            <data>
                <xpath expr="//field[@name='job_id']" position="before">
                    <field name="x_opportunities" widget="many2many_tags"/>
                </xpath>
                <xpath expr="//field[@name='linkedin_profile']" position="after">
                    <field name="x_is_shared_cv" widget="many2many_binary"/>
                </xpath>
                <xpath expr="//field[@name='priority']" position="before">
                    <field name="employee_id"/>
                </xpath>
                <xpath expr="//field[@name='type_id']" position="after">
                    <field name="x_available"/>
                </xpath>
                <xpath expr="//field[@name='availability']" position="attributes">
                    <attribute name="invisible">not x_available</attribute>
                </xpath>
            </data>
        </field>
    </record>
    <record id="hr_applicant_category_customization_search_view" model="ir.ui.view">
        <field name="name">hr.applicant.view.search.customization</field>
        <field name="model">hr.applicant</field>
        <field name="type">search</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_search_bis" />
        <field name="mode">extension</field>
        <field name="active" eval="True"/>
        <field name="priority">160</field>
        <field name="arch" type="xml">
            <data>
                <xpath expr="//field[@name='partner_name']" position="before">
                    <field name="x_opportunities" />
                    <field name="x_stage_name"/>
                </xpath>
                <xpath expr="//filter[@name='responsible']" position="after">
                    <filter name="group_by_opportunities" string="Opportunities" context="{'group_by': 'x_opportunities'}" />
                </xpath>
                <xpath expr="//filter[@name='applicants']" position="after">
                    <filter string="Job Positions" name="job_positions" domain="[('job_id.x_status_bar', 'not in', ['draft', 'done'])]"/>
                </xpath>
            </data>
        </field>
    </record>
    <record id="hr_kanban_view_applicant_inherit_view" model="ir.ui.view">
        <field name="name">hr.applicants.kanban.inherit.view</field>
        <field name="model">hr.applicant</field>
        <field name="active" eval="True"/>
        <field name="inherit_id" ref="hr_recruitment.hr_kanban_view_applicant"/>
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="inside">
                <field name="x_available"/>
                <field name="availability"/>
            </xpath>
            <xpath expr="//t[@t-name='card']/field[@name='partner_name']" position="after">
                <t t-if="record.x_available.raw_value === false">
                    <div class="text-muted small mt-1">
                        <span class="text-danger fw-bold">Unavailable</span>
                    </div>
                </t>
                <t t-elif="record.availability.raw_value">
                    <div class="text-muted small mt-1">
                        <field class="text-warning fw-bold" name="availability"/>
                    </div>
                </t>
            </xpath>
            <xpath expr="//field[@name='rotting_days']" position="after">
                <button name="%(ir_actions_server_for_email_pop_up)d" string="Send CV" type="action" class="btn btn-outline-primary btn-sm" invisible="x_is_cv_sent"/>
                <button name="%(ir_actions_server_for_email_pop_up)d" string="CV Sent" type="action" class="btn btn-outline-success btn-sm" invisible="not x_is_cv_sent"/>
            </xpath>
        </field>
    </record>
    <record id="view_hr_job_form_inherit_view" model="ir.ui.view">
        <field name="name">hr.job.form.inherit.view</field>
        <field name="model">hr.job</field>
        <field name="active" eval="True"/>
        <field name="inherit_id" ref="hr.view_hr_job_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <field name="x_status_bar" widget="statusbar" options="{'clickable': '1'}"/>
                <button name="%(ir_actions_server_create_sale_order_from_job)d" string="Create Sales order" type="action" invisible="x_quotation_sales_order" class="btn-primary"/>
            </xpath>
             <xpath expr="/form//field[@name='is_published']" position="after">
                <button class="oe_stat_button" type="action" name="%(ir_actions_server_view_opportunity)d" invisible="not x_opportunity" string="Opportunity" icon="fa-tag"/>
                <button class="oe_stat_button" type="action" name="%(ir_actions_server_view_sales_order)d" invisible="not x_quotation_sales_order" string="Sales Order" icon="fa-edit"/>
                <button type="action" name="%(ir_actions_server_view_invoices)d" class="oe_stat_button" icon="fa-pencil-square-o" invisible="not x_invoice_count">
                    <field name="x_invoice_count" widget="statinfo" string="Invoices"/>
                </button>
            </xpath>
            <xpath expr="//group[@id='job_skills']/field[@name='current_job_skill_ids']" position="after">
                <field name="x_recruitment_type"/>
                <field name="x_customer" invisible="x_recruitment_type != &quot;External&quot;"/>
                <field name="x_hiring_team_contact" widget="many2many_tags_email" invisible="x_recruitment_type != &quot;External&quot;" domain="[('id', 'in', x_customer_children_ids)]"/>
                <button name="%(ir_actions_server_check_portal_access)d" string="Grant Portal Access" type="action" class="btn-primary" invisible="not x_has_portal_access"/>
            </xpath>
            <xpath expr="//page[@name='recruitment_page']/group/group[@name='hiring_process']/div" position="after">
                <field name="x_opportunity"/>
                <field name="x_quotation_sales_order"/>
                <field name="x_invoices" widget="many2many_tags"/>
            </xpath>
            <xpath expr="//page[@name='trackers_page']" position="after">
                <page string="Client Description" name="client_description_page" groups="hr.group_hr_user">
                    <field name="x_client_description" options="{'collaborative': true}" placeholder="e.g. Summarize the position in one or two lines..."/>
                </page>
                <page string="Job Description" name="job_description_page_custom" groups="hr.group_hr_user">
                    <field name="x_job_description" options="{'collaborative': true}" placeholder="e.g. Summarize the position in one or two lines..."/>
                </page>
                <page string="Applicant Description" name="applicant_description_page" groups="hr.group_hr_user">
                    <field name="x_applicant_description" options="{'collaborative': true}" placeholder="e.g. Summarize the position in one or two lines..."/>
                </page>
                <page string="Offer Description" name="offer_description_page" groups="hr.group_hr_user">
                    <field name="x_offer_description" options="{'collaborative': true}" placeholder="e.g. Summarize the position in one or two lines..."/>
                </page>
            </xpath>
            <xpath expr="//sheet/notebook" position="inside">
                <page string="Similar Job Position" name="similar_job_page">
                    <field name="x_similar_job_ids" mode="list" context="{'default_department_id': department_id, 'default_x_recruitment_type': x_recruitment_type, 'default_company_id': company_id}">
                        <list>
                            <field name="name"/>
                            <field name="department_id"/>
                            <field name="x_recruitment_type"/>
                            <field name="x_matching_percentage" widget="progressbar"/>
                            <field name="x_matching_skills" widget="many2many_tags"/>
                            <field name="x_missing_skills" widget="many2many_tags"/>
                            <field name="x_customer" column_invisible="parent.x_recruitment_type == 'Internal'"/>
                            <field name="company_id" column_invisible="parent.x_recruitment_type == 'External'"/>
                        </list>
                    </field>
                </page>
            </xpath>
        </field>
    </record>
    <record id="hr_job_survey_inherit_view" model="ir.ui.view">
        <field name="name">hr.job.survery.form.inherit.view</field>
        <field name="model">hr.job</field>
        <field name="active" eval="True"/>
        <field name="inherit_id" ref="hr_recruitment.hr_job_survey"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']/button[@name='%(hr_recruitment.action_hr_job_applications)d']" position="attributes">
                <attribute name="invisible">x_status_bar == 'draft'</attribute>
            </xpath>
        </field>
    </record>
    <record id="hr_job_list_view_inherit" model="ir.ui.view">
        <field name="name">hr.job.list.inherit.view</field>
        <field name="inherit_id" ref="hr.view_hr_job_tree"/>
        <field name="model">hr.job</field>
        <field name="active" eval="True"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='department_id']" position="after">
                <field name="x_matching_percentage" optional="show" widget="progressbar"/>
            </xpath>
        </field>
    </record>
    <!-- cv sent views -->
    <record id="view_cv_sent_applicant_list" model="ir.ui.view">
        <field name="name">cv.sent.applicant.list</field>
        <field name="model">x_cv_sent_application</field>
        <field name="active" eval="True"/>
        <field name="arch" type="xml">
            <list string="CV Sent Applicants">
                <field name="x_applicant_id"/>
                <field name="x_job_id"/>
                <field name="x_cv" widget="many2many_binary"/>
                <field name="x_availability"/>
                <field name="x_cv_sent_date"/>
                <field name="x_is_published"/>
            </list>
        </field>
    </record>
    <record id="view_cv_sent_applicant_form" model="ir.ui.view">
        <field name="name">cv.sent.applicant.form</field>
        <field name="model">x_cv_sent_application</field>
        <field name="active" eval="True"/>
        <field name="arch" type="xml">
            <form string="CV Sent Applicant">
                <sheet>
                    <group>
                        <group>
                            <field name="x_applicant_id"/>
                            <field name="x_job_id" readonly="1"/>
                            <field name="x_cv" widget="many2many_binary"/>
                        </group>
                        <group>
                            <field name="x_availability"/>
                            <field name="x_cv_sent_date"/>
                            <field name="x_is_published"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record id="view_cv_sent_applicant_search" model="ir.ui.view">
        <field name="name">cv.sent.applicant.search</field>
        <field name="model">x_cv_sent_application</field>
        <field name="active" eval="True"/>
        <field name="arch" type="xml">
            <search string="Search CV Sent Applicants">
                <field name="x_applicant_id"/>
                <field name="x_job_id"/>
                <group>
                    <filter name="group_by_job" string="Job Position" context="{'group_by':'x_job_id'}"/>
                </group>
            </search>
        </field>
    </record>
</odoo>
