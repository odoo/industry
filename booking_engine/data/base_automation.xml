<?xml version='1.0' encoding='UTF-8'?>
<odoo>
  <record id="industry_on_slot_fix_times" model="base.automation">
    <field name="model_id" ref="planning.model_planning_slot"/>
    <field name="action_server_ids" eval="[(6, 0, [ref('industry_fix_slot_times')])]"/>
    <field name="trigger">on_create_or_write</field>
    <field name="name">Fix Slot Times</field>
    <field name="trigger_field_ids" eval="[(6, 0, [ref('planning.field_planning_slot__end_datetime'), ref('planning.field_planning_slot__start_datetime'), ref('sale_planning.field_planning_slot__sale_line_id')])]"/>
  </record>
  <record id="industry_on_rental_order_create" model="base.automation">
    <field name="model_id" ref="sale.model_sale_order"/>
    <field name="action_server_ids" eval="[(6, 0, [ref('industry_set_rental_hours')])]"/>
    <field name="trigger">on_create_or_write</field>
    <field name="name">Set Rental Start/Return Hours on Create</field>
    <field name="filter_domain">[('rental_start_date', '!=', False), ('rental_return_date', '!=', False)]</field>
    <field name="trigger_field_ids" eval="[(6, 0, [ref('sale_renting.field_sale_order__rental_start_date'), ref('sale_renting.field_sale_order__rental_return_date')])]"/>
  </record>
  <record id="industry_on_product_template_create" model="base.automation">
    <field name="model_id" ref="product.model_product_template"/>
    <field name="action_server_ids" eval="[(6, 0, [ref('industry_create_roles')])]"/>
    <field name="trigger">on_create_or_write</field>
    <field name="filter_domain">[("x_is_a_room_offer", "!=", False), ("planning_role_id", "=", False)]</field>
    <field name="name">Create role on stay offer creation</field>
  </record>
  <record id="industry_on_product_template_edit" model="base.automation">
    <field name="model_id" ref="product.model_product_template"/>
    <field name="action_server_ids" eval="[(6, 0, [ref('industry_edit_roles')])]"/>
    <field name="trigger">on_write</field>
    <field name="filter_domain">[("x_is_a_room_offer", "!=", False)]</field>
    <field name="name">Edit role name on stay offer modification</field>
  </record>
  <record id="industry_on_product_template_delete" model="base.automation">
    <field name="model_id" ref="product.model_product_template"/>
    <field name="action_server_ids" eval="[(6, 0, [ref('industry_delete_roles')])]"/>
    <field name="trigger">on_unlink</field>
    <field name="filter_domain">[("x_is_a_room_offer", "!=", False)]</field>
    <field name="name">Delete role on stay offer deletion</field>
  </record>

    <!-- House Keeping -->
    <record id="automation_on_check_in" model="base.automation">
        <field name="name">HouseKeeping: On check in</field>
        <field name="model_id" ref="sale.model_sale_order"/>
        <field name="action_server_ids" eval="[(6, 0, [ref('server_action_set_resources_occupied')])]"/>
        <field name="trigger">on_create_or_write</field>
        <field name="filter_domain">[('rental_status', 'in', ['return'])]</field>
        <field name="filter_pre_domain">[('rental_status', 'not in', ['return'])]</field>
        <field name="trigger_field_ids" eval="[(6, 0, [ref('sale_renting.field_sale_order__rental_status')])]"/>
    </record>
    <record id="automation_on_check_out" model="base.automation">
        <field name="name">HouseKeeping: On check out</field>
        <field name="model_id" ref="sale.model_sale_order"/>
        <field name="action_server_ids" eval="[(6, 0, [ref('server_action_set_resources_vacant')])]"/>
        <field name="trigger">on_create_or_write</field>
        <field name="filter_domain">[('rental_status', 'in', ['returned'])]</field>
        <field name="filter_pre_domain">[('rental_status', 'not in', ['returned'])]</field>
        <field name="trigger_field_ids" eval="[(6, 0, [ref('sale_renting.field_sale_order__rental_status')])]"/>
    </record>
    <record id="automation_on_task_stage_clean" model="base.automation">
        <field name="name">HouseKeeping: On task stage reaching Clean</field>
        <field name="model_id" ref="project.model_project_task"/>
        <field name="action_server_ids" eval="[(6, 0, [ref('server_action_set_task_ready_if_no_approvers')])]"/>
        <field name="trigger">on_create_or_write</field>
        <field name="filter_domain" eval="[('stage_id', 'in', [ref('project_task_type_17')])]"/>
        <field name="trigger_field_ids" eval="[(6, 0, [ref('project.field_project_task__stage_id')])]"/>
    </record>
    <record id="automation_on_task_stage_ready" model="base.automation">
        <field name="name">HouseKeeping: On task stage set to Ready</field>
        <field name="model_id" ref="project.model_project_task"/>
        <field name="action_server_ids" eval="[(6, 0, [ref('server_action_check_has_right_to_approve_tasks')])]"/>
        <field name="trigger">on_change</field>
        <field name="filter_domain" eval="[('stage_id', 'in', [ref('project_task_type_18')])]"/>
        <field name="on_change_field_ids" eval="[(6, 0, [ref('project.field_project_task__stage_id')])]"/>
    </record>
    <record id="automation_on_task_stage_modified" model="base.automation">
        <field name="name">HouseKeeping: On stage change</field>
        <field name="model_id" ref="project.model_project_task"/>
        <field name="action_server_ids" eval="[(6, 0, [ref('server_action_update_task_cleaning_state')])]"/>
        <field name="trigger">on_create_or_write</field>
        <field name="filter_pre_domain">[('project_id.x_is_house_keeping_project', '!=', False)]</field>
        <field name="trigger_field_ids" eval="[(6, 0, [ref('project.field_project_task__stage_id')])]"/>
    </record>
</odoo>
